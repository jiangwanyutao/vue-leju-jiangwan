(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6aca1154"],{"02cf":function(t,e,i){},"1b62":function(t,e,i){"use strict";var n=i("03e8");e["a"]={data:function(){return{start:1,limit:10,page:{currentPage:1,size:10,total:0,pageSizes:[10,20,30,40]},loadingOption:{background:"rgba(255,255,255,.9)",text:"拼了老命加载中.....",spinner:"el-icon-loading"},uploadUrl:"/lejuAdmin/material/uploadFileOss"}},methods:{handleSizeChange:function(t){this.page.size=t,this.page.currentPage=1,this.init()},handleCurrentChange:function(t){this.page.currentPage=t,this.init()}},computed:{headers:function(){var t=Object(n["b"])(),e={token:t};return e}}}},"29b4":function(t,e,i){},5278:function(t,e,i){"use strict";i("02cf")},"6bd5":function(t,e,i){"use strict";i("29b4")},"6c7a":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"detail p_bottom"},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.pageLoading,expression:"pageLoading"}],staticClass:"article_main",attrs:{"element-loading-text":t.loadingOption.text,"element-loading-spinner":t.loadingOption.spinner,"element-loading-background":t.loadingOption.background}},[i("el-card",{staticClass:"card",attrs:{shadow:"never"}},[i("div",{attrs:{slot:"header"},slot:"header"},[i("span",[t._v(t._s(t.$route.params.id?"编辑":"新增")+"文章")])]),i("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"120px",inline:!0,size:"normal"}},[i("el-form-item",{attrs:{prop:"author",size:"small",label:"作者"}},[i("el-input",{staticClass:"form_ipt",staticStyle:{width:"250px"},attrs:{placeholder:"作者姓名"},model:{value:t.form.author,callback:function(e){t.$set(t.form,"author",e)},expression:"form.author"}})],1),i("el-form-item",{attrs:{size:"small",prop:"title",label:"标题"}},[i("el-input",{staticClass:"form_ipt",staticStyle:{width:"250px"},attrs:{placeholder:"文章标题"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),i("el-form-item",{staticStyle:{"margin-left":"40px"},attrs:{size:"small",label:"是否显示"}},[i("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.form.isShow,callback:function(e){t.$set(t.form,"isShow",e)},expression:"form.isShow"}})],1),i("br"),i("el-form-item",{attrs:{size:"small",label:"摘要"}},[i("el-input",{staticClass:"form_ipt_long",staticStyle:{width:"800px"},attrs:{placeholder:"摘要",autosize:{minRows:3,maxRows:3},type:"textarea"},model:{value:t.form.summary,callback:function(e){t.$set(t.form,"summary",e)},expression:"form.summary"}})],1),i("br"),i("el-form-item",{attrs:{size:"small",label:"封面图片"}},[i("el-upload",{ref:"materialUpload",staticClass:"upload-demo",attrs:{action:t.uploadUrl,headers:t.headers,"on-success":t.handleUploadSucc}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传素材")]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 只能上传jpg/png文件，且不超过500kb ")])],1),t.form.coverImg?i("img",{staticClass:"uploadImg",attrs:{src:t.form.coverImg,alt:""}}):t._e()],1),i("br"),i("el-form-item",{staticStyle:{display:"block",width:"100%"},attrs:{size:"small",label:"切换富文本类型"}},[i("el-radio-group",{on:{change:t.toggleEditType},model:{value:t.form.editorType,callback:function(e){t.$set(t.form,"editorType",e)},expression:"form.editorType"}},[i("el-radio",{attrs:{label:0}},[t._v("富文本")]),i("el-radio",{attrs:{label:1}},[t._v("markdown")])],1),i("span",{staticClass:"warin"},[i("i",{staticClass:"el-icon-warning"}),t._v(" 注意!切换编辑器会清空编辑内容 ")])],1),i("el-upload",{directives:[{name:"show",rawName:"v-show",value:0===t.form.editorType,expression:"form.editorType === 0"}],ref:"innerUpload",staticClass:"upload-demo",attrs:{action:t.uploadUrl,headers:t.headers,"on-success":t.handleInnerImg}},[i("el-button",{staticStyle:{"margin-bottom":"5px"},attrs:{type:"primary",size:"small"}},[t._v("插入图片↓")])],1),0===t.form.editorType?i("div",[i("TEditor",{ref:"tin",model:{value:t.form.content1,callback:function(e){t.$set(t.form,"content1",e)},expression:"form.content1"}})],1):t._e(),1===t.form.editorType?i("div",[i("mavon-editor",{ref:"mavon",on:{imgAdd:t.imgAdd,change:t.getMarkDownHtml},model:{value:t.form.content2,callback:function(e){t.$set(t.form,"content2",e)},expression:"form.content2"}})],1):t._e(),i("div",{staticClass:"flexCenter"},[i("el-form-item",{attrs:{size:"small"}},[i("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.onSubmit}},[t._v(t._s(t.id?"立即修改":"立即新增"))])],1)],1)],1)],1)],1)])},a=[],o=i("5530"),r=i("1b62"),s=i("b63a"),l=i("8256"),c={name:"detail",mixins:[r["a"]],components:{TEditor:l["a"]},data:function(){return{id:"",pageLoading:!1,loading:!1,rules:{author:[{required:!0,message:"请输入作者姓名",trigger:"blur"},{min:2,max:20,message:"长度在 3 到 5 个字符",trigger:"blur"}],title:[{required:!0,message:"请输入文章标题",trigger:"blur"}]},form:{author:"",collectCount:"",content1:"",content2:"",coverImg:"",createTime:"",editorType:0,id:"",isShow:1,modifyTime:"",summary:"",title:"",viewCount:"",zanCount:""}}},methods:{getArticleDetail:function(){var t=this;this.pageLoading=!0,Object(s["e"])(this.id).then((function(e){e.success?(t.form=e.data.productArticle,t.form.isShow=t.form.isShow?1:0,t.$nextTick((function(){0===t.form.editorType&&(t.form.content1=t.form.content1,t.form.content2=t.form.content1)}))):t.$message.error("获取文章内容失败"),t.pageLoading=!1}))},toggleEditType:function(t){t&&(this.form.content1=this.form.content2="")},handleUploadSucc:function(t){t.success?this.form.coverImg=t.data.fileUrl:this.$message.error("素材上传失败")},handleInnerImg:function(t){t.success?(this.$refs.innerUpload.clearFiles(),this.$refs.tin.imageSuccessCBK(t.data.fileUrl)):this.$message.error("素材上传失败")},getMarkDownHtml:function(t,e){console.log(t,e),this.form.content2=e},imgAdd:function(t,e){var i=this,n=new FormData;n.append("file",e),Object(s["g"])(n).then((function(e){i.$refs.mavon.$img2Url(t,e.data.fileUrl)}))},onSubmit:function(){var t=this;this.form.content1||this.form.content2?this.$refs.form.validate((function(e){e?(t.loading=!0,t.id?Object(s["f"])(Object(o["a"])({},t.form)).then((function(e){e.success?(console.log(e),t.$router.push({name:"contentArticle"})):t.$message.error("修改失败"),t.loading=!1})):Object(s["a"])(Object(o["a"])({},t.form)).then((function(e){e.success?(console.log(e),t.$router.push({name:"contentArticle"})):t.$message.error("添加失败"),t.loading=!1}))):t.$message.warning("请填写必要信息")})):this.$message.warning("文章内容不能为空")}},computed:{},created:function(){this.id=this.$route.params.id,this.id&&this.getArticleDetail()},mounted:function(){}},u=c,d=(i("6bd5"),i("2877")),m=Object(d["a"])(u,n,a,!1,null,"080cd336",null);e["default"]=m.exports},8256:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tinymce-container",class:{fullscreen:t.fullscreen},style:{width:t.containerWidth}},[i("textarea",{staticClass:"tinymce-textarea",attrs:{id:t.tinymceId}})])},a=[],o=(i("b680"),i("a9e3"),i("ac1f"),i("00b4"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"upload-container"},[i("el-button",{style:{background:t.color,borderColor:t.color},attrs:{icon:"el-icon-upload",size:"mini",type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v(" upload ")]),i("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-upload",{staticClass:"editor-slide-upload",attrs:{multiple:!0,"file-list":t.fileList,"show-file-list":!0,"on-remove":t.handleRemove,"on-success":t.handleSuccess,"before-upload":t.beforeUpload,action:"https://httpbin.org/post","list-type":"picture-card"}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v(" Click upload ")])],1),i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v(" Cancel ")]),i("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v(" Confirm ")])],1)],1)}),r=[],s=(i("d3b7"),i("b64b"),i("d81d"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861"),{name:"EditorSlideUpload",props:{color:{type:String,default:"#1890ff"}},data:function(){return{dialogVisible:!1,listObj:{},fileList:[]}},methods:{checkAllSuccess:function(){var t=this;return Object.keys(this.listObj).every((function(e){return t.listObj[e].hasSuccess}))},handleSubmit:function(){var t=this,e=Object.keys(this.listObj).map((function(e){return t.listObj[e]}));this.checkAllSuccess()?(this.$emit("successCBK",e),this.listObj={},this.fileList=[],this.dialogVisible=!1):this.$message("Please wait for all images to be uploaded successfully. If there is a network problem, please refresh the page and upload again!")},handleSuccess:function(t,e){for(var i=e.uid,n=Object.keys(this.listObj),a=0,o=n.length;a<o;a++)if(this.listObj[n[a]].uid===i)return this.listObj[n[a]].url=t.files.file,void(this.listObj[n[a]].hasSuccess=!0)},handleRemove:function(t){for(var e=t.uid,i=Object.keys(this.listObj),n=0,a=i.length;n<a;n++)if(this.listObj[i[n]].uid===e)return void delete this.listObj[i[n]]},beforeUpload:function(t){var e=this,i=window.URL||window.webkitURL,n=t.uid;return this.listObj[n]={},new Promise((function(a,o){var r=new Image;r.src=i.createObjectURL(t),r.onload=function(){e.listObj[n]={hasSuccess:!1,uid:t.uid,width:this.width,height:this.height}},a(!0)}))}}}),l=s,c=(i("5278"),i("2877")),u=Object(c["a"])(l,o,r,!1,null,"3dae379b",null),d=u.exports,m=["advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"],f=m,h=["searchreplace bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap preview anchor pagebreak insertdatetime media table emoticons forecolor backcolor fullscreen"],p=h,g=i("b85c"),b=[];function v(){return window.tinymce}var y=function(t,e){var i=document.getElementById(t),n=e||function(){};if(!i){var a=document.createElement("script");a.src=t,a.id=t,document.body.appendChild(a),b.push(n);var o="onload"in a?r:s;o(a)}function r(e){e.onload=function(){this.onerror=this.onload=null;var t,i=Object(g["a"])(b);try{for(i.s();!(t=i.n()).done;){var n=t.value;n(null,e)}}catch(a){i.e(a)}finally{i.f()}b=null},e.onerror=function(){this.onerror=this.onload=null,n(new Error("Failed to load "+t),e)}}function s(t){t.onreadystatechange=function(){if("complete"===this.readyState||"loaded"===this.readyState){this.onreadystatechange=null;var e,i=Object(g["a"])(b);try{for(i.s();!(e=i.n()).done;){var n=e.value;n(null,t)}}catch(a){i.e(a)}finally{i.f()}b=null}}}i&&n&&(v()?n(null,i):b.push(n))},w=y,_=i("b63a"),j="https://cdn.jsdelivr.net/npm/tinymce-all-in-one@4.9.3/tinymce.min.js",k={name:"Tinymce",components:{editorImage:d},props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{type:String,default:"file edit insert view format table"},height:{type:[Number,String],required:!1,default:360},width:{type:[Number,String],required:!1,default:"auto"}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id,fullscreen:!1,languageTypeList:{en:"en",zh:"zh_CN",es:"es_MX",ja:"ja"}}},computed:{containerWidth:function(){var t=this.width;return/^[\d]+(\.[\d]+)?$/.test(t)?"".concat(t,"px"):t}},watch:{value:function(t){var e=this;!this.hasChange&&this.hasInit&&this.$nextTick((function(){return window.tinymce.get(e.tinymceId).setContent(t||"")}))}},mounted:function(){this.init()},activated:function(){window.tinymce&&this.initTinymce()},deactivated:function(){this.destroyTinymce()},destroyed:function(){this.destroyTinymce()},methods:{init:function(){var t=this;w(j,(function(e){e?t.$message.error(e.message):t.initTinymce()}))},initTinymce:function(){var t=this,e=this;window.tinymce.init({selector:"#".concat(this.tinymceId),language:this.languageTypeList["zh"],height:this.height,body_class:"panel-body ",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:p,menubar:this.menubar,plugins:f,end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["www.tinymce.com","codepen.io"],default_link_target:"_blank",link_title:!1,nonbreaking_force_tab:!0,init_instance_callback:function(i){e.value&&i.setContent(e.value),e.hasInit=!0,i.on("NodeChange Change KeyUp SetContent",(function(){t.hasChange=!0,t.$emit("input",i.getContent())}))},setup:function(t){t.on("FullscreenStateChanged",(function(t){e.fullscreen=t.state}))},convert_urls:!1,images_upload_handler:function(t,i,n,a){a(0);var o=new FormData;o.append("file",t.blob()),Object(_["g"])(o).then((function(t){t.success?(i(t.data.fileUrl),a(100)):(e.$message.error("上传失败,请重新上传"),a(100))}))}})},destroyTinymce:function(){var t=window.tinymce.get(this.tinymceId);this.fullscreen&&t.execCommand("mceFullScreen"),t&&t.destroy()},setContent:function(t){window.tinymce.get(this.tinymceId).setContent(t)},getContent:function(){return window.tinymce.get(this.tinymceId).getContent()},imageSuccessCBK:function(t){window.tinymce.get(this.tinymceId).insertContent('<img class="wscnph" src="'.concat(t,'" >'))}}},C=k,O=(i("ecde"),Object(c["a"])(C,n,a,!1,null,"4ed0cef5",null));e["a"]=O.exports},"92ec":function(t,e,i){},b63a:function(t,e,i){"use strict";i.d(e,"d",(function(){return a})),i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return s})),i.d(e,"e",(function(){return l})),i.d(e,"f",(function(){return c})),i.d(e,"g",(function(){return u}));i("99af");var n=i("b775");function a(t,e,i){return Object(n["a"])({url:"/lejuAdmin/productArticle/findArticles/".concat(t,"/").concat(e),method:"POST",data:i})}function o(t){return Object(n["a"])({url:"/lejuAdmin/productArticle/changeShowStatus",method:"POST",data:t})}function r(t){return Object(n["a"])({url:"/lejuAdmin/productArticle/del/".concat(t),method:"DELETE"})}function s(t){return Object(n["a"])({url:"/lejuAdmin/productArticle/addArticle",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/lejuAdmin/productArticle/productArticle/".concat(t)})}function c(t){return Object(n["a"])({url:"/lejuAdmin/productArticle/updateArticle",method:"post",data:t})}function u(t){return Object(n["a"])({url:"/lejuAdmin/material/uploadFileOss",method:"POST",data:t})}},ecde:function(t,e,i){"use strict";i("92ec")}}]);